<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <meta http-equiv="X-UA-Compatible"/>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
  <title><%= page_title controller.controller_name, controller.action_name %></title>
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>

  <%= csrf_meta_tag %>

  <%= javascript_include_tag 'savage_beast/application.js' -%>
  <%= javascript_include_tag 'prototype.js','prototype_ujs.js', 'effects.js', 'dragdrop.js', 'boxover.js',
                             'scriptaculous.js', 'controls.js', 'redbox.js', 'builder.js', 'application.js',
                             'tagging.js', 'autocompleter_advanced.js', 'publication.js','top_menu.js',
                             'dynamic_menu.js', :cache=>'js_cached' %>


  <%= stylesheets = ['reset-fonts-grids', 'base-min', 'my_exp', 'folds', 'gadgets', 'acts_as_taggable_stylesheet',
                     'styles', 'favourites', 'fast_auto_complete', 'redbox', 'autocompleter_advanced',
                     'alphabetical_pagination', 'savage_beast/forums', 'site_announcements', 'tabnav','top_menu',
                     'dynamic_menu', 'biovel']
      stylesheets = stylesheets << 'local' if File.exists?('public/stylesheets/local.css')
      stylesheets << {:cache => 'css_cached'}

      stylesheet_link_tag *stylesheets %>

  <script type="text/javascript">
      function show_ajax_loader(element) {
          $(element).innerHTML =<%= ("'" + image_tag("ajax-loader.gif") + "'").html_safe -%>;
      }
      function show_large_ajax_loader(element) {
          $(element).innerHTML =<%= ("'" + image_tag("ajax-loader-large.gif") + "'").html_safe -%>
      }
  </script>

</head>

<body id="body">
<div id="container">

  <div id="header" class="clearfix">
    <div>
      <%= link_to image_tag("seek-logo-smaller.png", :alt => "SEEK", :title => "SEEK", :style => "height: 50px"), root_path, :style => "float: left" %>
      <ul class="menutabs clearfix">
        <%= navigation_link 'Home', root_path, nil, controller_name == 'homes' -%>
        <%= navigation_link 'Workflows', workflows_path, nil, controller_name == 'workflows' -%>
        <%= navigation_link 'Runs', '#', nil, controller_name == 'runs' -%>
        <%= navigation_link 'Data', data_files_path, nil, controller_name == 'data_files' -%>
      </ul>
      <ul class="menutabs clearfix" style="float: right">
        <% if logged_in? && current_user.person %>
          <%= navigation_link current_user.person.name, current_user.person, nil, false -%>
          <%= navigation_link('Admin', admin_path, nil, false) if admin_logged_in? -%>
          <%= navigation_link 'Log out', logout_path, nil, false -%>
        <% else %>
          <%= navigation_link 'Log in', new_session_path, nil, false -%>
        <% end %>
      </ul>
      <%= render :partial=>"search/search_box" %>
    </div>
  </div>

  <div id="bd">
    <div id="yui-main">
      <div id="content">
        <table width="100%">
          <tr>
            <td>
              <div class="breadcrumbs">
                <%= render_breadcrumbs :separator => ' > ' %>
              </div>
            </td>

            <td class="return_to_search" id='return_to_search'>
              <%= add_return_to_search %>
            </td>
          </tr>
        </table>

        <%# applying styling to error / notice messages -%>
        <% if flash[:error] %>
            <div id="error_flash" class="box_standout curved with_smaller_shadow" style="color: red; margin: 0.8em 0.8em; line-height: 1.4;">
              <%= link_to_function image_tag("close.gif", :style => "float: right;"),"new Effect.toggle('error_flash','slide',{duration:0.3});" %>
              <%= flash[:error] %>
            </div>
        <% end %>
        <% if flash[:notice] %>
            <div id="notice_flash" class="box_standout curved with_smaller_shadow" style="color: green; margin: 0.8em 0.8em; line-height: 1.4;">
              <%= link_to_function image_tag("close.gif", :style => "float: right;"),"new Effect.toggle('notice_flash','slide',{duration:0.3});" %>
              <%= flash[:notice] %>
            </div>
        <% end %>



        <%# main content part of every page -%>
        <%= yield :layout %>

      </div>
      <br style="clear:both"/>
    </div>
  </div>

  <div id="ft">
    <div>
      <%= render :partial=>"layouts/footer" %>
    </div>
  </div>

<%# NB! These javascript include should be here - otherwise folds / tabs will not be displayed on any pages. -%>
<%= javascript_include_tag "folds.js" %>
<%= javascript_include_tag "tabber-minimized.js" %>

<%= piwik_tracking_tag %>
</div>
</body>
</html>
