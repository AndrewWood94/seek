<style>
  ul.publishing_options {
      padding-left: 1em;
  }

  ul.publishing_options li.type_and_title {
      font-weight:bolder;
  }

  ul.publishing_options li.title {
      font-weight:bolder;
  }

  ul.publishing_options li.secondary {
      padding-left: 1em;
  }

  ul.publishing_options li.published {
      color: green;
  }

  ul.publishing_options li.owned {
      color: orange;
  }

  ul.publishing_options li.protected {
      color: red;
  }

<%

studies = @asset.assays.collect(&:study).uniq
investigations = studies.collect(&:investigation).uniq

-%>

</style>
<div class="show_basic">

  <h1>Publishing preview for the <%= asset_type_name -%> '<%= @asset.title -%>' and related assets. </h1>

  <p class="box_standout">
    Publishing automates the process of publically releasing your Assets (Data files, SOPs or Models) along with any associated
    Investigations, Studies or Assays.<br/>
    To secure publishing process, each project has an option to define the gatekeepers, who give the approval or reject of publishing request. <br/>
    However it is optional, so if a project doesn't define any gatekeepers, the project assets can be made published immediately.<br/>
    Having the permission to manage an asset, you can immediately publish the asset or submit the publishing request to the gatekeepers if defined, otherwise a notification email can be sent to the owner of the asset.<br/>
    If there is an asset you do not wish to make public, then you can uncheck the checkbox beside that asset and it will remain unaffected.<br/>
  </p>

  <p>
    You are about to process publishing for the <%= "#{asset_type_name} '#{link_to @asset.title,@asset}'" -%>. <br/>
    Below are the other entries in SEEK related to this asset.
  </p>

  <% form_tag :action=>:isa_publish do -%>
      <h2>Assays related to this <%= asset_type_name -%> and their assets.</h2>
      <ul>
        <% if @asset.assays.empty? -%>
            <span class="none_text">There are no Assays related to this <%= asset_type_name -%>.</span>
            <div style="padding-left: 2em;">
              <%= render :partial=>"assets/publishing/options_for_isa_publishing", :collection=>[@asset], :locals=>{:html_classes=>"publishing_options"} -%>
            </div>
        <% else -%>
            <% @asset.assays.each do |assay| -%>
                <%= render :partial=>"assets/publishing/options_for_isa_publishing", :object=>assay, :locals=>{:html_classes=>"publishing_options"} -%>
                <div style="padding-left: 2em;">
                    <%= render :partial=>"assets/publishing/options_for_isa_publishing", :collection=>assay.asset_masters, :locals=>{:html_classes=>"publishing_options"} -%>
                </div>
            <% end -%>

        <% end -%>
      </ul>

      <h2>Studies related to this <%= asset_type_name -%></h2>
      <ul>
        <% if studies.empty? -%>
            <span class="none_text">There are no Studies related to this <%= asset_type_name -%>.</span>
        <% else -%>
            <%= render :partial=>"assets/publishing/options_for_isa_publishing", :collection=>studies, :locals=>{:html_classes=>"publishing_options"} -%>
        <% end -%>
      </ul>
      
      <h2>Investigations related to this <%= asset_type_name -%></h2>
      <ul>
        <% if investigations.empty? -%>
            <span class="none_text">There are no Investigations related to this <%= asset_type_name -%>.</span>
        <% else -%>

            <%= render :partial=>"assets/publishing/options_for_isa_publishing", :collection=>investigations, :locals=>{:html_classes=>"publishing_options"} -%>
        <% end -%>
      </ul>

      <%= submit_tag "Submit",:disable_with=>"Submitting ..." -%>

  <% end -%>

</div>




